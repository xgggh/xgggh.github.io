(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-744c4772","chunk-2d0b368a","chunk-2d219f9b","chunk-2d209afc"],{"27f5":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dropdown",{staticStyle:{"margin-right":"10px"},on:{command:t.platformChanged}},[r("el-button",{attrs:{size:t.size,type:"primary"}},[t._v(" "+t._s(t.platformName)+" "),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.platformList,(function(e){return r("el-dropdown-item",{key:e.id,attrs:{command:e.id}},[t._v(t._s(e.name))])})),1)],1)},o=[],a=(r("a4d3"),r("e01a"),r("d28b"),r("b0c0"),r("a9e3"),r("d3b7"),r("3ca3"),r("ddb0"),r("96cf"),r("1fbf")),i=r("22ce"),c={name:"platform-selector",props:{value:{type:Number},size:{type:String,default:"small"}},data:function(){return{platformId:1,platformName:"",platformList:[],platformDict:{url:"/user/v1/platform/list",getData:function(t,e){return Object(i["b"])({url:t}).then((function(t){return t.data}))},value:"id",label:"name"}}},created:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return null!=this.value&&(this.platformId=this.value),e.next=3,regeneratorRuntime.awrap(a["d2CrudPlus"].util.dict.get(this.platformDict));case 3:this.platformList=e.sent,t=this.getById(this.platformId,!0),null!=t&&(this.platformId=t.id,this.platformName=t.name),this.$emit("init",this.platformId);case 7:case"end":return e.stop()}}),null,this)},methods:{getById:function(t,e){if(null==this.platformList)return null;if(null!=t){var r=!0,n=!1,o=void 0;try{for(var a,i=this.platformList[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var c=a.value;if(c.id===t)return c}}catch(l){n=!0,o=l}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}}return e&&this.platformList.length>0?this.platformList[0]:void 0},platformChanged:function(t){var e=this.getById(t,!1);null!=e&&(this.platformId=e.id,this.platformName=e.name,this.$emit("change",e.id))}}},l=c,u=r("2877"),s=Object(u["a"])(l,n,o,!1,null,null,null);e["default"]=s.exports},"32d7":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("d2-container",{class:{"page-compact":t.crud.pageOptions.compact}},[r("template",{slot:"header"},[t._v("资源管理 "),r("example-helper",{attrs:{title:"权限管理帮助"}},[r("div",[r("link-button",{attrs:{href:"http://greper.gitee.io/d2-crud-plus/guide/permission.html"}},[t._v("权限管理帮助文档")])],1)])],1),r("d2-crud-x",{ref:"d2Crud",attrs:{columns:t.crud.columns,data:t.crud.list,rowHandle:t.crud.rowHandle,"edit-title":"修改资源","add-template":t.crud.addTemplate,"add-rules":t.crud.addRules,"edit-template":t.crud.editTemplate,"edit-rules":t.crud.editRules,"form-options":t.crud.formOptions,options:t.crud.options,expandRow:t.crud.expandRow},on:{"dialog-open":t.handleDialogOpen,"row-edit":t.handleRowEdit,"row-add":t.handleRowAdd,"row-remove":t.handleRowRemove,"dialog-cancel":t.handleDialogCancel,"form-data-change":t.handleFormDataChange,"add-sub-resource":t.handleAddSubResource}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("crud-search",{ref:"search",attrs:{options:t.crud.searchOptions},on:{submit:t.handleSearch}}),r("platform-selector",{attrs:{slot:"header",size:"small"},on:{change:t.platformChanged,init:t.platformInit},slot:"header"}),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"p:resource:create",expression:"'p:resource:create'"}],staticClass:"d2-mb-5",attrs:{slot:"header",size:"small",type:"primary"},on:{click:t.addRootRow},slot:"header"},[r("i",{staticClass:"el-icon-plus"}),t._v(" 新增")]),r("crud-toolbar",{attrs:{search:t.crud.searchOptions.show,compact:t.crud.pageOptions.compact,columns:t.crud.columns},on:{"update:search":function(e){return t.$set(t.crud.searchOptions,"show",e)},"update:compact":function(e){return t.$set(t.crud.pageOptions,"compact",e)},refresh:function(e){return t.doRefresh()},"columns-filter-changed":t.handleColumnsFilterChanged}})],1)])],2)},o=[],a=r("a9b0"),i=r("1fbf"),c=r("ba17"),l=r("aa6f"),u=r.n(l),s=r("27f5"),d={name:"Resource",mixins:[i["d2CrudPlus"].crud],components:{PlatformSelector:s["default"]},data:function(){return{platformId:1}},methods:{doLoad:function(){},platformInit:function(t){this.platformId=t,this.getSearch().setForm({platformId:t},!0),this.getSearch().doSearch()},platformChanged:function(t){this.platformInit(t)},getCrudOptions:function(){return Object(a["crudOptions"])(this)},pageRequest:function(t){var e=this;return Object(c["GetTree"])(t).then((function(t){var r=t.data;return t.data={current:1,size:1e4,total:100,records:r},setTimeout((function(){var t=e.getD2Crud().$refs.elTable.store.states.treeData;null!=t&&u()(t,(function(t,e){t.children&&t.level<=1&&(t.expanded=!0)}))}),1),t}))},clearResourceTreeDictCache:function(){i["d2CrudPlus"].util.dict.clear("/permission/manager/resource/tree")},addRequest:function(t){return this.clearResourceTreeDictCache(),Object(c["AddObj"])(t)},updateRequest:function(t){return this.clearResourceTreeDictCache(),Object(c["UpdateObj"])(t)},delRequest:function(t){return this.clearResourceTreeDictCache(),Object(c["DelObj"])(t.id)},infoRequest:function(t){return Object(c["GetObj"])(t.id)},handleAddSubResource:function(t){t.index;var e=t.row;this.addRow({parentId:e.id,platformId:e.platformId})},addRootRow:function(){this.addRow({parentId:0,platformId:this.platformId})}}},p=d,f=r("2877"),m=Object(f["a"])(p,n,o,!1,null,null,null);e["default"]=m.exports},a9b0:function(t,e,r){"use strict";r.r(e),r.d(e,"crudOptions",(function(){return o}));r("b0c0");var n=r("22ce"),o=function(t){return{rowHandle:{edit:{disabled:function(){return!t.hasPermissions("p:platform:edit")}},remove:{disabled:function(){return!t.hasPermissions("p:platform:del")}},custom:[{text:"添加",type:"primary",size:"small",emit:"add-sub-resource",icon:"el-icon-plus"}],width:280,fixed:"right"},options:{height:"100%",highlightCurrentRow:!0,rowKey:"id"},columns:[{title:"资源名称",key:"title",sortable:!0,search:{},form:{component:{props:{placeholder:"菜单名称"}}},width:200},{title:"id",key:"id",form:{disabled:!0},sortable:!0},{title:"父节点",key:"parentId",sortable:!0,width:90,type:"tree-selector",dict:{url:"/user/v1/resource/tree",isTree:!0,value:"id",label:"title",getData:function(t,e){return Object(n["b"])({url:t}).then((function(t){return[{id:0,title:"根节点",children:t.data}]}))}},form:{component:{props:{multiple:!1,elProps:{defaultExpandAll:!0}}}}},{title:"图标",key:"icon",sortable:!1,type:"icon-selector",width:60},{title:"资源代码",key:"name",sortable:!0,search:{},form:{component:{props:{placeholder:"路由的name"}}},width:170},{title:"权限代码",key:"permission",sortable:!0,search:{},form:{component:{props:{placeholder:"aaa:bbb:ccc"}}},width:170},{title:"路由地址",key:"path",sortable:!0,search:{},form:{component:{props:{placeholder:"permission/resource"}}},width:180},{title:"路由组件",key:"component",sortable:!0,search:{},form:{component:{props:{placeholder:""}},helper:"layoutHeaderAside或/permission/views/resource"},width:180},{title:"排序",key:"sort",sortable:!0},{title:"资源类型",key:"type",type:"select",align:"center",width:100,search:{},dict:{url:"/common/v1/resource/dict/list",getData:function(t,e){return Object(n["b"])({url:t}).then((function(t){return t.data}))},cache:!0},sortable:!0},{title:"所属平台",key:"platformId",type:"select",disabled:!0,search:{disabled:!0},dict:{url:"/user/v1/platform/list",value:"id",label:"name"},addForm:{component:{disabled:!1}},form:{component:{disabled:!0},valueChange:function(e,r){console.log("-----你选择了",r,t.crud.columnsMap.platformId.component.props.dict.dataMap[r].name)}},sortable:!0}]}}},aa6f:function(t,e){var r=9007199254740991,n="[object Arguments]",o="[object Function]",a="[object GeneratorFunction]",i=/^(?:0|[1-9]\d*)$/;function c(t,e){var r=-1,n=t?t.length:0;while(++r<n)if(!1===e(t[r],r,t))break;return t}function l(t,e){var r=-1,n=Array(t);while(++r<t)n[r]=e(r);return n}function u(t,e){return function(r){return t(e(r))}}var s=Object.prototype,d=s.hasOwnProperty,p=s.toString,f=s.propertyIsEnumerable,m=u(Object.keys,Object);function h(t,e){var r=C(t)||k(t)?l(t.length,String):[],n=r.length,o=!!n;for(var a in t)!e&&!d.call(t,a)||o&&("length"==a||j(a,n))||r.push(a);return r}var b=y(g),v=O();function g(t,e){return t&&v(t,e,L)}function w(t){if(!R(t))return m(t);var e=[];for(var r in Object(t))d.call(t,r)&&"constructor"!=r&&e.push(r);return e}function y(t,e){return function(r,n){if(null==r)return r;if(!x(r))return t(r,n);var o=r.length,a=e?o:-1,i=Object(r);while(e?a--:++a<o)if(!1===n(i[a],a,i))break;return r}}function O(t){return function(e,r,n){var o=-1,a=Object(e),i=n(e),c=i.length;while(c--){var l=i[t?c:++o];if(!1===r(a[l],l,a))break}return e}}function j(t,e){return e=null==e?r:e,!!e&&("number"==typeof t||i.test(t))&&t>-1&&t%1==0&&t<e}function R(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||s;return t===r}function I(t,e){var r=C(t)?c:b;return r(t,"function"==typeof e?e:P)}function k(t){return D(t)&&d.call(t,"callee")&&(!f.call(t,"callee")||p.call(t)==n)}var C=Array.isArray;function x(t){return null!=t&&_(t.length)&&!S(t)}function D(t){return T(t)&&x(t)}function S(t){var e=A(t)?p.call(t):"";return e==o||e==a}function _(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}function A(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function T(t){return!!t&&"object"==typeof t}function L(t){return x(t)?h(t):w(t)}function P(t){return t}t.exports=I},ba17:function(t,e,r){"use strict";r.r(e),r.d(e,"GetList",(function(){return i})),r.d(e,"GetTree",(function(){return c})),r.d(e,"AddObj",(function(){return l})),r.d(e,"UpdateObj",(function(){return u})),r.d(e,"DelObj",(function(){return s})),r.d(e,"GetObj",(function(){return d}));var n=r("22ce"),o="/user/v1/resource",a="/user/v1/permission";function i(t){return Object(n["b"])({url:o,method:"get",params:t})}function c(t){return Object(n["b"])({url:a+"/tree/list",method:"get",params:t})}function l(t){return Object(n["b"])({url:o,method:"post",data:t})}function u(t){return Object(n["b"])({url:o+"/"+t.id,method:"put",data:t})}function s(t){return Object(n["b"])({url:o+"/"+t,method:"delete",params:{id:t}})}function d(t){return Object(n["b"])({url:o+"/",method:"get",params:{id:t}})}}}]);